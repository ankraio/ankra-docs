---
title: Credentials
description: Securely manage authentication credentials for registries, Git providers, and external services.
---

Credentials in Ankra store authentication information for connecting to external services like Helm registries, container registries, and Git providers. Credentials are securely stored and can be referenced when configuring integrations.

---

## Credential Types

<CardGroup cols={2}>
  <Card title="Registry Credentials" icon="box">
    Authenticate with Helm chart registries (HTTP and OCI).
  </Card>
  <Card title="Git Credentials" icon="code-branch">
    Connect to GitHub, GitLab, and other Git providers.
  </Card>
  <Card title="Hetzner API Credentials" icon="cloud">
    Authenticate with Hetzner Cloud for cluster provisioning.
  </Card>
  <Card title="SSH Key Credentials" icon="lock">
    SSH keys for server access on provisioned clusters.
  </Card>
</CardGroup>

---

## Registry Credentials

Registry credentials authenticate with Helm chart repositories. They're used when syncing charts from private registries.

### Creating a Registry Credential

<Steps>
  <Step title="Navigate to Credentials">
    Go to **Credentials** in the Ankra dashboard.
  </Step>
  <Step title="Add Credential">
    Click **Add** and select **Registry** as the provider type.
  </Step>
  <Step title="Enter Details">
    - **Name**: A unique identifier (e.g., `ghcr-auth`, `harbor-prod`)
    - **Username**: Your registry username
    - **Password**: Your registry password or access token
  </Step>
  <Step title="Save">
    Click **Create** to securely store the credential.
  </Step>
</Steps>

### Provider-Specific Setup

<AccordionGroup>
  <Accordion title="GitHub Container Registry (GHCR)">
    **Create a Personal Access Token:**
    1. Go to GitHub → Settings → Developer settings → Personal access tokens
    2. Generate a token with `read:packages` scope
    3. For pushing charts, also add `write:packages`

    **Credential values:**
    - Username: Your GitHub username
    - Password: The Personal Access Token
  </Accordion>

  <Accordion title="Google Artifact Registry">
    **Create a Service Account:**
    1. Go to Google Cloud Console → IAM → Service Accounts
    2. Create a new service account
    3. Grant "Artifact Registry Reader" role
    4. Create and download a JSON key

    **Credential values:**
    - Username: `_json_key`
    - Password: The entire JSON key file contents
  </Accordion>

  <Accordion title="Amazon ECR">
    **Get an auth token:**
    ```bash
    aws ecr get-login-password --region us-east-1
    ```

    **Credential values:**
    - Username: `AWS`
    - Password: The token from the command above

    <Warning>
    ECR tokens expire after 12 hours. For production, consider using IAM roles or refresh the token regularly.
    </Warning>
  </Accordion>

  <Accordion title="Azure Container Registry">
    **Create a Service Principal:**
    ```bash
    az ad sp create-for-rbac --name ankra-acr-reader \
      --scopes /subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.ContainerRegistry/registries/{registry} \
      --role acrpull
    ```

    **Credential values:**
    - Username: The `appId` from the output
    - Password: The `password` from the output
  </Accordion>

  <Accordion title="Docker Hub">
    **Create an Access Token:**
    1. Go to Docker Hub → Account Settings → Security
    2. Create a new Access Token with Read permissions

    **Credential values:**
    - Username: Your Docker Hub username
    - Password: The Access Token (not your password)
  </Accordion>

  <Accordion title="Harbor">
    **Use a robot account (recommended):**
    1. Go to your Harbor project → Robot Accounts
    2. Create a new robot account with pull permissions

    **Credential values:**
    - Username: `robot$project+name` (the robot account name)
    - Password: The robot account secret
  </Accordion>

  <Accordion title="JFrog Artifactory">
    **Create an API Key or Access Token:**
    1. Go to User Profile → Edit Profile
    2. Generate an API Key or create an Access Token

    **Credential values:**
    - Username: Your Artifactory username
    - Password: The API Key or Access Token
  </Accordion>
</AccordionGroup>

---

## Hetzner API Credentials

Hetzner API credentials store your Hetzner Cloud API token, used when provisioning and managing Hetzner clusters. The token is validated against the Hetzner API on creation.

### Creating a Hetzner API Credential

<Steps>
  <Step title="Get a Hetzner API Token">
    1. Log in to the [Hetzner Console](https://console.hetzner.cloud)
    2. Select your project
    3. Go to **Security** → **API Tokens**
    4. Click **Generate API Token** with **Read & Write** permissions
    5. Copy the token (it's only shown once)
  </Step>
  <Step title="Add to Ankra (UI)">
    Go to **Credentials** → **Add** → **Hetzner**, enter a name and paste your API token.
  </Step>
  <Step title="Or via CLI">
    ```bash
    ankra credentials hetzner create --name my-hetzner-token --api-token hc_xxxxx
    ```
  </Step>
</Steps>

### Listing Hetzner Credentials

<CodeGroup>

```bash CLI
ankra credentials hetzner list
```

```bash cURL
curl https://platform.ankra.app/api/v1/credentials/hetzner \
  -H "Authorization: Bearer $ANKRA_API_TOKEN"
```

</CodeGroup>

---

## SSH Key Credentials

SSH key credentials store public keys that are deployed to servers during cluster provisioning. You can either provide your own public key or let Ankra generate a keypair for you.

### Creating an SSH Key Credential

<Steps>
  <Step title="Choose an approach">
    - **Bring your own key**: Provide an existing SSH public key
    - **Generate a keypair**: Ankra generates a new Ed25519 keypair and returns the private key for you to save
  </Step>
  <Step title="Add to Ankra (UI)">
    Go to **Credentials** → **Add** → **SSH Key**, enter a name, and either paste your public key or choose **Generate**.
  </Step>
  <Step title="Or via CLI">
    ```bash
    # Generate a new keypair
    ankra credentials hetzner ssh-key create --name my-key --generate

    # Or provide your own public key
    ankra credentials hetzner ssh-key create --name my-key \
      --public-key "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5..."
    ```
  </Step>
</Steps>

<Warning>
When generating a keypair, the private key is only returned once. Save it immediately to a secure location.
</Warning>

### Listing SSH Key Credentials

<CodeGroup>

```bash CLI
ankra credentials hetzner ssh-key list
```

```bash cURL
curl https://platform.ankra.app/api/v1/credentials/hetzner/ssh-keys \
  -H "Authorization: Bearer $ANKRA_API_TOKEN"
```

</CodeGroup>

---

## Using Credentials

### With Helm Registries

When adding a registry, select the credential to use for authentication:

1. Go to **Charts** → **Repositories** → **Add**
2. Enter the registry URL
3. Select the credential from the dropdown
4. Click **Add**

Ankra will use the credential when syncing charts from the registry.

### With GitOps

Credentials are automatically used when syncing configurations to GitHub repositories connected via OAuth.

---

## Managing Credentials

### View Credentials

Go to **Credentials** to see all stored credentials:
- Name and type
- Creation date
- Associated registries (if any)

### Update a Credential

1. Click on the credential name
2. Update the username or password
3. Click **Save**

<Note>
Updating a credential automatically applies to all registries using it. No need to reconfigure registries.
</Note>

### Delete a Credential

1. Go to **Credentials**
2. Click the menu (⋮) next to the credential
3. Select **Delete**

<Warning>
Deleting a credential will break authentication for any registries using it. Update those registries first.
</Warning>

---

## Security

### Storage

Credentials are stored securely using HashiCorp Vault:
- Encrypted at rest
- Access controlled per organization
- Audit logging for all access

### Best Practices

<CardGroup cols={2}>
  <Card title="Use Tokens, Not Passwords" icon="key">
    Prefer access tokens over account passwords. Tokens can be scoped and revoked independently.
  </Card>
  <Card title="Minimum Permissions" icon="shield">
    Grant only the permissions needed. For chart sync, read-only access is sufficient.
  </Card>
  <Card title="Rotate Regularly" icon="rotate">
    Rotate credentials periodically, especially for production registries.
  </Card>
  <Card title="Separate by Environment" icon="layer-group">
    Use different credentials for dev, staging, and production registries.
  </Card>
</CardGroup>

---

## Troubleshooting

### Authentication Errors

| Error | Cause | Solution |
|-------|-------|----------|
| 401 Unauthorized | Invalid credentials | Verify username and password/token |
| 403 Forbidden | Insufficient permissions | Check the token has required scopes |
| Token expired | Temporary tokens (ECR) | Refresh the token |
| Connection refused | Network issue | Check firewall and network access |

### Common Issues

**"unauthorized: authentication required"**
- The credential wasn't selected when adding the registry
- Edit the registry and select the correct credential

**"invalid username/password"**
- The token may have been revoked or expired
- Regenerate the token and update the credential

**"permission denied"**
- The token doesn't have read access to the repository
- Update the token permissions or use a different account

---

## API Access

Manage credentials via the Ankra API:

```python
import requests

headers = {"Authorization": f"Bearer {TOKEN}"}

# List credentials
response = requests.get(
    "https://platform.ankra.app/api/v1/credentials",
    headers=headers
)

# Create credential
response = requests.post(
    "https://platform.ankra.app/api/v1/credentials",
    headers=headers,
    json={
        "name": "my-registry-auth",
        "provider": "registry",
        "username": "myuser",
        "password": "mytoken"
    }
)
```

See the [API Reference](/api-reference) for complete documentation.
